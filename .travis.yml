# Modify this line to test Travis Integration ...
sudo: required

language: python

matrix:
  include:
    - os: linux
      sudo: required
      services:
        - docker
      install:
        - docker pull ffig/ffig-base
        - docker build . -t ffig-ci
      before_install:
        - pip install autopep8
      script:
        - docker run ffig-ci /bin/bash -c "./scripts/build.py -t --python-path python2 --venv"
        - docker run ffig-ci /bin/bash -c "./scripts/build.py -T \"CPP|MOCKS\" -c ASAN --python-path python2 --venv"
        - docker run ffig-ci /bin/bash -c "./scripts/build.py -t --python-path python3 --venv"
        - docker run ffig-ci /bin/bash -c "./scripts/build.py -T \"CPP|MOCKS\" -c ASAN --python-path python3 --venv"
        - ./scripts/codechecks.py

    - os: osx
      language: generic
      osx_image: xcode9.2
      install:
        - brew update
        - brew install ninja python3
        - curl https://download.microsoft.com/download/1/1/5/115B762D-2B41-4AF3-9A63-92D9680B9409/dotnet-sdk-2.1.4-osx-gs-x64.pkg --output dotnet-sdk-2.1.4-osx-gs-x64.pkg --silent
        - sudo sudo installer -pkg dotnet-sdk-2.1.4-osx-gs-x64.pkg
        - pip2 install --user --upgrade pip && pip2 install --user jinja2 nose pycodestyle
        - pip3 install --user --upgrade pip && pip3 install --user jinja2 nose pycodestyle
        - gem install ffi
      script:
        - ./scripts/build.py -t
        - ./scripts/build.py -t --python-path python3

notifications:
  slack:
    rooms:
      - c-api:ZTxxqvEcr25iaaB8XBS7luaA#travis-ci
